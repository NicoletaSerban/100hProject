<%- include('partials/header') -%>
<div class="container main">
  <div class="row">
   <!-- start profile box -->
    <div class="col-7 mx-auto pt-5">
      <div class="card pt-5" style="background-image:url(/imgs/back2.png)" >
        <div class="card-img-top row" alt="...">
          <img class="rounded d-block img-fluid " id="avatar" src="https://avatars.dicebear.com/api/big-smile/:seed.png" >
        </div>
        
        <div class="card-body text-center">
          <h5 class="card-title text-peach"></strong> <%= user.userName %>'s profile</h5>
          <p class="card-text">
            <ul class="list-unstyled text-light">
            <li><strong>Email</strong>: <%= user.email %></li>
            <li><strong>Role</strong>: <%= user.role %></li>
            <li><strong>Adorable</strong>: <%= user.rating %></li>
            <li><strong>Reported</strong>: <%= user.reported %></li>

            <!-- start rate/adorable form -->
            <li><strong>
              <form
                action="/user/rate/<%=user._id%>?_method=PUT"
                method="POST"
              >
            <!-- if the user already clicked Adorable btn the btn will not be display anymore -->
              <% if (errorRate) { %>
                <button type="button" class="btn btn-success mb-1" disabled><%=errorRate%> </button>
                 <% } else { %>
                  <li>Adorable?<button class="btn" type="submit">
                  <i class="fas fa-paw"></i>
                </button>
                  <% } %>
            </li>
           
              </form>
              
              <!-- end rate/adorable form -->
            </li>
            
            <!-- start reported form -->
            <li><strong>
              <form
                action="/user/reported/<%= user.id %>?_method=PUT"
                method="POST"
              >
              <% if (errorReport) { %>
                <button type="button" class="btn btn-danger" disabled><%=errorReport%> </button></div>
                 <% } else { %>
              <li>Report user:<button class="btn" type="submit"> <i class="fas fa-frown"></i>
              </button>
              <% } %>
            </li>
              </form>
              <!-- end reported form -->

              <!-- appears only if the conditionals are true -->
          <div class=" d-flex justify-content-center w-auto">
          <% if (user.reported > 100) { %>
            <div class="alert alert-danger" role="alert">
                User has many reports!
              </div>
              <% } else if(user.rating > 10){ %> 
                <div class="alert alert-success" role="alert">
                  User has many positive votes!
                </div> 
                <% } %>
            </div>
            <!-- end of info -->
          </ul>
        </p>
        
        
          
        <!-- end card body -->
        
        <!-- end card-->
      </div>
        <!-- end div profile box-->
    </div>

    <!-- user posts starts -->
      <h2 class="text-center pt-4 text-powder"><%=user.userName%>'s posts</h2>
      <div class="col-5 section-bg">
        <ul class="row list-unstyled text-center" >
          <!-- display all the posts from the user -->
          <% for(post of posts) {%>
          <div class="col-6 justify-content-between mt-5">
            <a href="/animal/<%=post._id%>" class="text-decoration-none">
              <img class="img-fluid" src="<%=post.image%>" />
              <ul class="list-unstyled link-secondary text-light">
                <li><strong>Name</strong>: <%= post.name %></li>
                <li><strong>Posted on</strong>: <%= post.postDate.toLocaleString() %></li>
              </ul>
            </a>
          </div>
          <% } %>
        </ul>
        <!-- end div user posts -->
      </div>

      <!-- end div row -->
    </div>
    <!-- end div container -->
  </div>
 <!-- end div container -->
<%- include('partials/footer') -%>
